module_name: MICROSTRAIN

serial_config:
    - command: sleep 1; microstrain start -d ${SERIAL_DEV}
      port_config_param:
        name: SENS_MS_CFG
        group: Sensors

parameters:
    - group: Sensors
      definitions:

        MS_MODE:
            description:
                short: MicroStrain device mode
                long: |
                    Sensor mode publishes raw IMU data to be used by EKF2. INS data from the device is published to the external INS topics.
                    INS mode publishes the INS data to the vehicle topics to be used for navigation.
            type: enum
            values:
                0: Sensor Mode
                1: INS Mode
            reboot_required: true
            default: 0

        MS_IMU_RATE_HZ:
            description:
                short: MicroStrain IMU data rate
                long: |
                    Accelerometer and Gyroscope data rate (Hz).
                    Valid rates: 0 or any factor of 1000.
            type: int32
            max: 1000
            min: 0
            reboot_required: true
            default: 500

        MS_MAG_RATE_HZ:
            description:
                short: MicroStrain magnetometer data rate
                long: |
                    Magnetometer data rate (Hz).
                    Valid rates: 0 or any factor of 1000.
            type: int32
            max: 1000
            min: 0
            reboot_required: true
            default: 50

        MS_BARO_RATE_HZ:
            description:
                short: MicroStrain barometer data rate
                long: |
                    Barometer data rate (Hz).
                    Valid rates: 0 or any factor of 1000.
            type: int32
            max: 1000
            min: 0
            reboot_required: true
            default: 50

        MS_FILT_RATE_HZ:
            description:
                short: MicroStrain EKF data rate
                long: |
                    The rate at which the INS data is published (Hz).
                    Valid rates: 0 or any factor of 1000.
            type: int32
            max: 1000
            min: 0
            reboot_required: true
            default: 250

        MS_GNSS_RATE_HZ:
            description:
                short: MicroStrain GNSS data rate
                long: |
                    GNSS receiver 1 and 2 data rate (Hz).
                    Valid rates: 0, 1 or 5.
            type: int32
            max: 5
            min: 0
            reboot_required: true
            default: 5

        MS_ALIGNMENT:
            description:
                short: MicroStrain heading alignment type
                long: |
                    Select the source of heading alignment.
            type: bitmask
            bit:
                0: Dual-antenna GNSS
                1: GNSS kinematic (requires motion, e.g. a GNSS velocity)
                2: Magnetometer
                3: External Heading (first valid external heading will be used to initialize the filter)
            max: 15
            min: 1
            reboot_required: true
            default: 2

        MS_GNSS_AID_SRC:
            description:
                short: MicroStrain GNSS aiding source control
                long: |
                    Select the source of gnss aiding (GNSS/INS).
            type: enum
            values:
                1: All internal receivers
                2: External GNSS messages
                3: GNSS receiver 1 only
                4: GNSS receiver 2 only
            reboot_required: true
            default: 1

        MS_INT_MAG_EN:
            description:
                short: Enable MicroStrain internal magnetometer
                long: |
                    Toggles internal magnetometer aiding in the device filter.
            type: enum
            values:
                0: Disabled
                1: Enabled
            reboot_required: true
            default: 0

        MS_EXT_MAG_EN:
            description:
                short: Enable MicroStrain external magnetometer aiding
                long: |
                    Toggles external magnetometer aiding in the device filter.
            type: enum
            values:
                0: Disabled
                1: Enabled
            reboot_required: true
            default: 0

        MS_INT_HEAD_EN:
            description:
                short: Enable MicroStrain internal heading aiding
                long: |
                    Toggles internal heading as an aiding measurement.
                    If dual antennas are supported (CV7-GNSS/INS). The filter will be configured to use dual antenna heading as an aiding measurement.
            type: enum
            values:
                0: Disabled
                1: Enabled
            reboot_required: true
            default: 0

        MS_EXT_HEAD_EN:
            description:
                short: Enable MicroStrain external heading aiding
                long: |
                    Toggles external heading as an aiding measurement.
                    If enabled, the filter will be configured to accept external heading as an aiding meaurement.
            type: enum
            values:
                0: Disabled
                1: Enabled
            reboot_required: true
            default: 0

        MS_OPT_FLOW_EN:
            description:
                short: Enable MicroStrain optical flow aiding
                long: |
                    Toggles body frame velocity as an aiding measurement.
                    The driver uses the body frame velocity from the optical flow sensor as the aiding measurements.
            type: enum
            values:
                0: Disabled
                1: Enabled
            reboot_required: true
            default: 0

        MS_SVT_EN:
            description:
                short: Enables Microstrain sensor to vehicle transform
                long: |
                    If the sensor has a different orientation with respect to the vehicle. This will enable a transform to correct itself.
                    The transform is described by MS_SENSOR_ROLL, MS_SENSOR_PITCH, MS_SENSOR_YAW.
            type: enum
            values:
                0: Disabled
                1: Enabled
            reboot_required: true
            default: 0

        MS_ACCEL_RANGE:
            description:
                short: MicroStrain accelerometer range
                long: |
                    -1 = Will not be configured, and will use the device default range.
                    Ranges vary by device and map to integer codes. Check the device's [User Manual](https://www.hbkworld.com/en/products/transducers/inertial-sensors#!ref_microstrain.com) for supported ranges and set the corresponding integer.
            type: int32
            reboot_required: true
            default: -1

        MS_GYRO_RANGE:
            description:
                short: MicroStrain gyroscope range
                long: |
                    -1 = Will not be configured, and will use the device default range.
                    Ranges vary by device and map to integer codes. Check the device's [User Manual](https://www.hbkworld.com/en/products/transducers/inertial-sensors#!ref_microstrain.com) for supported ranges and set the corresponding integer.
            type: int32
            reboot_required: true
            default: -1

        MS_GNSS_OFF1_X:
            description:
                short: MicroStrain GNSS lever arm offset 1 (X)
                long: |
                    Lever arm offset (m) in the X direction for the external GNSS receiver.
                    In the case of a dual antenna setup, this is antenna 1.
            type: float
            reboot_required: true
            default: 0.0

        MS_GNSS_OFF1_Y:
            description:
                short: MicroStrain GNSS lever arm offset 1 (Y)
                long: |
                    Lever arm offset (m) in the Y direction for the external GNSS receiver.
                    In the case of a dual antenna setup, this is antenna 1.
            type: float
            reboot_required: true
            default: 0.0

        MS_GNSS_OFF1_Z:
            description:
                short: MicroStrain GNSS lever arm offset 1 (Z)
                long: |
                    Lever arm offset (m) in the Z direction for the external GNSS receiver.
                    In the case of a dual antenna setup, this is antenna 1.
            type: float
            reboot_required: true
            default: 0.0

        MS_GNSS_OFF2_X:
            description:
                short: MicroStrain GNSS lever arm offset 2 (X)
                long: |
                    Lever arm offset (m) in the X direction for antenna 2
                    This will only be used if the device supports a dual antenna setup.
            type: float
            reboot_required: true
            default: 0.0

        MS_GNSS_OFF2_Y:
            description:
                short: MicroStrain GNSS lever arm offset 2 (Y)
                long: |
                    Lever arm offset (m) in the Y direction for antenna 2.
                    This will only be used if the device supports a dual antenna setup.
            type: float
            reboot_required: true
            default: 0.0

        MS_GNSS_OFF2_Z:
            description:
                short: MicroStrain GNSS lever arm offset 2 (Z)
                long: |
                    Lever arm offset (m) in the X direction for antenna 2.
                    This will only be used if the device supports a dual antenna setup.
            type: float
            reboot_required: true
            default: 0.0

        MS_SENSOR_ROLL:
            description:
                short: MicroStrain Sensor to vehicle transform (Roll)
                long: |
                    The orientation of the device (Radians) with respect to the vehicle frame around the x axis.
                    Requires MS_SVT_EN to be enabled to be used.
            type: float
            reboot_required: true
            default: 0.0

        MS_SENSOR_PTCH:
            description:
                short: MicroStrain Sensor to Vehicle Transform (Pitch)
                long: |
                    The orientation of the device (Radians) with respect to the vehicle frame around the y axis.
                    Requires MS_SVT_EN to be enabled to be used.
            type: float
            reboot_required: true
            default: 0.0

        MS_SENSOR_YAW:
            description:
                short: MicroStrain Sensor to Vehicle Transform (Yaw)
                long: |
                    The orientation of the device (Radians) with respect to the vehicle frame around the z axis.
                    Requires MS_SVT_EN to be enabled to be used.
            type: float
            reboot_required: true
            default: 0.0

        MS_EMAG_ROLL:
            description:
                short: MicroStrain External Magnetometer Orientation (Roll)
                long: |
                    The orientation of the device (Radians) with respect to the vehicle frame around the x axis.
                    Requires MS_EXT_MAG_EN to be enabled to be used.
            type: float
            reboot_required: true
            default: 0.0

        MS_EMAG_PTCH:
            description:
                short: MicroStrain External Magnetometer Orientation (Pitch)
                long: |
                    The orientation of the device (Radians) with respect to the vehicle frame around the y axis.
                    Requires MS_EXT_MAG_EN to be enabled to be used.
            type: float
            reboot_required: true
            default: 0.0

        MS_EMAG_YAW:
            description:
                short: MicroStrain External Magnetometer Orientation (Yaw)
                long: |
                    The orientation of the device (Radians) with respect to the vehicle frame around the z axis.
                    Requires MS_EXT_MAG_EN to be enabled to be used.
            type: float
            reboot_required: true
            default: 0.0

        MS_OFLW_OFF_X:
            description:
                short: MicroStrain optical flow offset (X)
                long: |
                    Offset (m) in the X direction if an Optical Flow sensor is connected.
                    Requires MS_OPT_FLOW_EN to be enabled to be used.
            type: float
            reboot_required: true
            default: 0.0

        MS_OFLW_OFF_Y:
            description:
                short: MicroStrain optical flow offset (Y)
                long: |
                    Offset (m) in the Y direction if an Optical Flow sensor is connected.
                    Requires MS_OPT_FLOW_EN to be enabled to be used.
            type: float
            reboot_required: true
            default: 0.0

        MS_OFLW_OFF_Z:
            description:
                short: MicroStrain optical flow offset (Z)
                long: |
                    Offset (m) in the Z direction if an Optical Flow sensor is connected.
                    Requires MS_OPT_FLOW_EN to be enabled to be used.
            type: float
            reboot_required: true
            default: 0.0

        MS_EHEAD_YAW:
            description:
                short: MicroStrain External Heading Orientation (Yaw)
                long: |
                    The orientation of the device (Radians) with respect to the vehicle frame around the z axis.
                    Requires MS_EXT_HEAD_EN to be enabled to be used.
            type: float
            reboot_required: true
            default: 0.0

        MS_EMAG_UNCERT:
            description:
                short: MicroStrain external magnetometer uncertainty
                long: |
                    The 1-sigma uncertainty (in Gauss) for all axes, which will remain constant across all aiding measurements.
                    Requires MS_EXT_MAG_EN to be enabled to be used.
            type: float
            reboot_required: true
            default: 0.1

        MS_OFLW_UNCERT:
            description:
                short: MicroStrain optical flow uncertainty
                long: |
                    The 1-sigma uncertainty (in m/s) for the X and Y axes, which will remain constant across all aiding measurements.
                    The Z axis is not used for aiding.
                    Requires MS_OPT_FLOW_EN to be enabled to be used.
            type: float
            reboot_required: true
            default: 0.1
